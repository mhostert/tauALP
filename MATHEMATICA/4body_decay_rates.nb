(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10562,        313]
NotebookOptionsPosition[      9325,        283]
NotebookOutlinePosition[      9720,        299]
CellTagsIndexPosition[      9677,        296]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   SqrtBox[
    RowBox[{"1", " ", "-", " ", 
     RowBox[{"2", 
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}], ")"}], 
       SuperscriptBox["a", "2"]]}], " ", "+", " ", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["b", "2"], "-", 
         SuperscriptBox["c", "2"]}], ")"}], "2"], 
      SuperscriptBox["a", "4"]]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mtaubarSQR", " ", "=", " ", 
   RowBox[{
    SuperscriptBox["mtau", "2"], "+", 
    SuperscriptBox["ma", "2"], "-", " ", 
    RowBox[{"2", "*", "mtau", "*", "Ea"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mvvSQRMax", " ", "=", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SqrtBox["mtaubarSQR"], " ", "-", " ", "mlep"}], ")"}], "2"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ifunc", "[", 
   RowBox[{"mtbarSQR_", ",", " ", "mvvSQR_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", " ", 
    RowBox[{"1", " ", "+", " ", 
     FractionBox[
      RowBox[{"mvvSQR", " ", "-", " ", 
       RowBox[{"2", "*", 
        SuperscriptBox["mlep", "2"]}]}], "mtaubarSQR"], "+", " ", 
     FractionBox[
      RowBox[{
       SuperscriptBox["mlep", "4"], "+", 
       RowBox[{
        SuperscriptBox["mlep", "2"], "mvvSQR"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["mvvSQR", "2"]}]}], 
      SuperscriptBox["mtaubarSQR", "2"]]}], ")"}], "*", 
   RowBox[{"v", "[", 
    RowBox[{
     SqrtBox["mtaubarSQR"], ",", 
     SqrtBox["mvvSQR"], ",", "mlep"}], " ", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.952542231699397*^9, 3.952542413400283*^9}, {
  3.952542471353366*^9, 3.9525424904765997`*^9}, {3.952542555401684*^9, 
  3.9525425815942*^9}, {3.952542715751911*^9, 3.952542734531591*^9}, {
  3.9526196890131693`*^9, 3.952619702209528*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"840ce88b-b898-4b1a-b250-126f4dbf2c13"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ifunc", "[", 
     RowBox[{"mtaubarSQR", ",", " ", "x"}], "]"}], "/.", 
    RowBox[{"ma", "->", " ", "0"}]}], "//", "Simplify"}], "//", 
  "PowerExpand"}]], "Input",
 CellChangeTimes->{{3.952542419241662*^9, 3.952542468121531*^9}, {
  3.9525425190014563`*^9, 3.952542551074247*^9}, {3.952542591067206*^9, 
  3.952542604146863*^9}, {3.9525426343320427`*^9, 3.952542641518798*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"a1b22146-bb01-46f4-981f-020a56d39f7f"],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   RowBox[{"1", "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["mlep", "2"]}], "+", "x"}], ")"}], "2"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "Ea", " ", "mtau"}], "+", 
        SuperscriptBox["mtau", "2"]}], ")"}], "2"]], "-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["mlep", "2"], "+", "x"}], ")"}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "Ea", " ", "mtau"}], "+", 
      SuperscriptBox["mtau", "2"]}]]}]], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["mlep", "2"]}], "+", "x"}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "Ea", " ", "mtau"}], "+", 
      SuperscriptBox["mtau", "2"]}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["mlep", "4"], "+", 
      RowBox[{
       SuperscriptBox["mlep", "2"], " ", "x"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["x", "2"]}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "Ea", " ", "mtau"}], "+", 
        SuperscriptBox["mtau", "2"]}], ")"}], "2"]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.95254244664478*^9, 3.952542457320929*^9}, {
   3.9525425149137373`*^9, 3.952542533264982*^9}, {3.952542591744966*^9, 
   3.9525426044725857`*^9}, {3.952542637424828*^9, 3.952542641803179*^9}, {
   3.952542737108015*^9, 3.952542741080544*^9}, 3.9526197222980547`*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"be58bab5-289a-4675-89de-6343511db494"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["mtaubarSQR"], "Input",
 CellChangeTimes->{{3.9526196816919003`*^9, 3.952619684191448*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"dd643721-e366-4a94-b8e4-6e7520d27c64"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["ma", "2"], "-", 
  RowBox[{"2", " ", "Ea", " ", "mtau"}], "+", 
  SuperscriptBox["mtau", "2"]}]], "Output",
 CellChangeTimes->{{3.952619677847569*^9, 3.952619684859702*^9}, 
   3.952619724265553*^9},
 CellLabel->
  "Out[159]=",ExpressionUUID->"a34f945a-f360-451a-b03f-dab0b773d8c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integral", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Ifunc", "[", 
       RowBox[{"mtaubarSQR", ",", " ", "x"}], "]"}], "//", "Simplify"}], "//",
      "PowerExpand"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "mvvSQRMax"}], "}"}], ",", " ", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ma", ">", "0"}], ",", " ", 
       RowBox[{"mlep", ">", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"mtau", " ", "-", " ", "mlep"}], " ", ">", " ", "ma"}], ",", 
       " ", 
       RowBox[{"Ea", ">", " ", "ma"}], ",", " ", 
       RowBox[{"Ea", " ", "<", 
        FractionBox[
         RowBox[{
          SuperscriptBox["mtau", "2"], "+", 
          SuperscriptBox["ma", "2"], "-", " ", 
          SuperscriptBox["mlep", "2"]}], 
         RowBox[{"2", " ", "mtau"}]]}]}], " ", "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9525426501373653`*^9, 3.952542669738353*^9}, {
  3.952542950924951*^9, 3.9525430294031677`*^9}, {3.952543205782735*^9, 
  3.952543261364788*^9}, {3.952543297649351*^9, 3.952543304743161*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"f1e95db9-20a1-47cd-abbb-d53afbc70cb4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["ma", "2"], "-", 
     RowBox[{"8", " ", 
      SuperscriptBox["mlep", "2"]}], "-", 
     RowBox[{"2", " ", "Ea", " ", "mtau"}], "+", 
     SuperscriptBox["mtau", "2"], "-", 
     FractionBox[
      SuperscriptBox["mlep", "8"], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["ma", "2"], "-", 
         RowBox[{"2", " ", "Ea", " ", "mtau"}], "+", 
         SuperscriptBox["mtau", "2"]}], ")"}], "3"]], "+", 
     FractionBox[
      RowBox[{"8", " ", 
       SuperscriptBox["mlep", "6"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["ma", "2"], "-", 
         RowBox[{"2", " ", "Ea", " ", "mtau"}], "+", 
         SuperscriptBox["mtau", "2"]}], ")"}], "2"]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"6", " ", 
    SuperscriptBox["mlep", "4"], " ", 
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{
       SuperscriptBox["ma", "2"], "-", 
       RowBox[{"2", " ", "Ea", " ", "mtau"}], "+", 
       SuperscriptBox["mtau", "2"]}], 
      SuperscriptBox["mlep", "2"]], "]"}]}], 
   RowBox[{
    SuperscriptBox["ma", "2"], "+", 
    RowBox[{"mtau", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "Ea"}], "+", "mtau"}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.952542657368855*^9, 3.952542672223255*^9}, 
   3.952542889261035*^9, 3.952543227215664*^9, 3.9525432578243723`*^9, 
   3.952543305751041*^9, 3.952543547040002*^9, 3.952619883913911*^9},
 CellLabel->
  "Out[160]=",ExpressionUUID->"2d28ab4f-257d-4817-bb10-c1cda8b35b47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "Integral", " ", "]"}]], "Input",
 CellChangeTimes->{{3.952543307999674*^9, 3.95254332583506*^9}, {
  3.952543392104995*^9, 3.952543393157504*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"fbf786e5-1bc6-49b9-b928-b097aaefdad1"],

Cell["\<\
(Power(ma,2) - 8*Power(mlep,2) - 2*Ea*mtau + Power(mtau,2) - 
      Power(mlep,8)/Power(Power(ma,2) - 2*Ea*mtau + Power(mtau,2),3) + 
      (8*Power(mlep,6))/Power(Power(ma,2) - 2*Ea*mtau + Power(mtau,2),2))/2. + 
   (6*Power(mlep,4)*Log((Power(ma,2) - 2*Ea*mtau + Power(mtau,2))/
        Power(mlep,2)))/(Power(ma,2) + mtau*(-2*Ea + mtau))\
\>", "Output",
 CellChangeTimes->{3.952544199427402*^9, 3.952619899525936*^9},
 CellLabel->
  "Out[161]//CForm=",ExpressionUUID->"79ff3dd8-1179-4b28-b41c-56f69b8e9db9"]
}, Open  ]]
},
WindowSize->{756, 832},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"feb074c1-377b-44bc-95b4-28eb81e874bb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2100, 61, 217, "Input",ExpressionUUID->"840ce88b-b898-4b1a-b250-126f4dbf2c13"],
Cell[CellGroupData[{
Cell[2683, 85, 522, 12, 30, "Input",ExpressionUUID->"a1b22146-bb01-46f4-981f-020a56d39f7f"],
Cell[3208, 99, 1769, 54, 121, "Output",ExpressionUUID->"be58bab5-289a-4675-89de-6343511db494"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5014, 158, 187, 3, 30, "Input",ExpressionUUID->"dd643721-e366-4a94-b8e4-6e7520d27c64"],
Cell[5204, 163, 324, 8, 34, "Output",ExpressionUUID->"a34f945a-f360-451a-b03f-dab0b773d8c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5565, 176, 1229, 31, 130, "Input",ExpressionUUID->"f1e95db9-20a1-47cd-abbb-d53afbc70cb4"],
Cell[6797, 209, 1685, 50, 124, "Output",ExpressionUUID->"2d28ab4f-257d-4817-bb10-c1cda8b35b47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8519, 264, 267, 5, 30, "Input",ExpressionUUID->"fbf786e5-1bc6-49b9-b928-b097aaefdad1"],
Cell[8789, 271, 520, 9, 120, "Output",ExpressionUUID->"79ff3dd8-1179-4b28-b41c-56f69b8e9db9"]
}, Open  ]]
}
]
*)

